[tool:pytest]
# Configuration for endpoint testing
testpaths = 
    tests/integration/test_comprehensive_endpoint_suite.py
    tests/unit/test_api_endpoints_unit.py

# Test markers for endpoint testing
markers =
    health: Health and status endpoint tests
    models: Model management endpoint tests
    dspy: DSPy pipeline endpoint tests
    mlflow: MLflow proxy endpoint tests
    auth: Authentication and security tests
    integration: Integration test scenarios
    unit: Unit tests with mocks
    slow: Slow running tests
    requires_auth: Tests that need API keys
    requires_mlflow: Tests that need MLflow server

# Options for endpoint testing
addopts = 
    -v
    --tb=short
    --strict-markers
    --strict-config
    --durations=10
    --color=yes
    -p no:warnings
    --maxfail=5

# Test discovery
python_files = 
    test_*endpoint*.py
    test_*api*.py
    test_comprehensive*.py

python_classes = 
    Test*Endpoints*
    Test*API*
    Test*Suite*

python_functions = 
    test_*

# Minimum Python version
minversion = 3.8

# Timeout for tests
timeout = 60

# Parallel execution settings
# -n auto to use all CPU cores: pytest -n auto
# Requires pytest-xdist: pip install pytest-xdist

# Coverage settings (if pytest-cov is installed)
# Requires pytest-cov: pip install pytest-cov
# --cov=src --cov-report=html --cov-report=term-missing

# Logging
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Filtering
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore:.*HTTPSConnection.*:urllib3.exceptions.InsecureRequestWarning

# Environment variables for testing
env = 
    TESTING=true
    PYTHONPATH=.
    MLFLOW_TRACKING_URI=file:///tmp/test_mlruns
    REDIS_HOST=localhost
    REDIS_PORT=6379